### 対策方法解説

対策方法としては下記の3つが有効です。

1. 利用者がアップロードしたファイルは公開ディレクトリに置かず、アプリケーション経由で閲覧させる。

2. アップロードできるファイルをスクリプト実行の可能性のないものに制限し、かつ、アップロード先ディレクトリの実行権限を落とす。

3. S3などの外部オブジェクトストレージを利用する。


1 はファイルを直接閲覧させず、アプリケーションを通して閲覧させることで実行そのものを禁止する方法です。  

2 はスクリプトファイルをアップロードさせず、また、仮にアップロードされてしまっても実行権限を落とすことで実行を防ぎます。

3 は外部のオブジェクトストレージを利用する事によって PHP や Ruby などのアプリケーション環境から隔離することで実行を防ぎます。
